<div class="h-full bg-gray-800 flex flex-col justify-center">

    @if(!isMeetingStarted()) {
    <button
        class="my-3 w-50 py-2 rounded-md text-gray-800 bg-gray-100 cursor-pointer outline-none hover:bg-gray-500 hover:text-gray-200 transition duration-700 self-center absolute top-4"
        (click)="startCall()">Start Call</button>
    }

    <!-- <span>Permission: {{permissionStatus()}}</span> -->
    <div class="grid grid-cols-1 gap-3 p-2" [ngClass]="isRemoteConnected() ? 'md:grid-cols-2' : 'md:grid-cols-1'">
        <div class="relative">
            <video class="video" #videoElement autoplay playsInline></video>
            @if(localUsername()) {
            <span class="text-gray-900 absolute bottom-0 ml-4 mb-4 p-1 rounded-2xl px-4 bg-gray-300">{{ localUsername()
                }}</span>
            }
        </div>

        <div class="relative" [class.hidden]="!isRemoteConnected()">
            <video class="video" #remoteVideoElement autoplay playsInline></video>
            @if(remoteUsername()) {
            <span class="text-gray-900 absolute bottom-0 ml-4 mb-4 p-1 rounded-2xl px-4 bg-gray-300">{{ remoteUsername()
                }}</span>
            }
        </div>
    </div>
    <div class="self-center absolute bottom-0">

        <div class="flex flex-row md:p-3 md:gap-3">

            <span class="flex flex-col items-center p-2">
                @if(isCameraEnabled()) {
                <span class="p-3 rounded-xl mb-1 bg-gray-900 cursor-pointer" (click)="toggleVideo()">
                    <img src="/icons/cam-on.svg" alt="cam-on">
                </span>
                }
                @else {
                <span class="p-3 rounded-xl mb-1 bg-gray-900 cursor-pointer" (click)="requestFullAccess()">
                    <img src="/icons/cam-off.svg" alt="cam-on">
                </span>
                }

                <span>Cam</span>
            </span>

            <span class="flex flex-col items-center p-2">
                @if(isAudioEnabled()) {
                <span class="p-3 rounded-xl mb-1 bg-gray-900 cursor-pointer" (click)="toggleAudio()">
                    <img src="/icons/mic-on.svg" alt="mic-on">
                </span>
                }
                @else {
                <span class="p-3 rounded-xl mb-1 bg-gray-900 cursor-pointer" (click)="requestFullAccess()">
                    <img src="/icons/mic-off.svg" alt="mic-on">
                </span>
                }
                <span>Mic</span>
            </span>

            <span class="flex flex-col items-center p-2">
                <span class="p-3 rounded-xl mb-1 bg-gray-900 cursor-pointer"
                    (click)="isSharingScreen() ? stopScreenShare() : shareScreen()">
                    <img src="/icons/screen-share.svg" alt="screen-share">
                </span>
                @if(isSharingScreen()) {
                <span>Stop</span>
                }
                @else {
                <span>Share</span>
                }
            </span>

            <span class="flex flex-col items-center p-2">
                <span class="p-3 rounded-xl mb-1 bg-gray-900 cursor-pointer" (click)="chat()">
                    <img src="/icons/chat.svg" alt="chat">
                </span>
                <span>Chat</span>
            </span>

            <span class="flex flex-col items-center p-2">
                <span class="p-3 rounded-xl mb-1 bg-[#F04438] cursor-pointer" (click)="leaveMeeting()">
                    <img src="/icons/waiting-room.svg" alt="waiting-room">
                </span>
                <span>Leave</span>
            </span>

        </div>
    </div>
</div>